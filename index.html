<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
        <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
        <!--tunes-->
        <section id="tunes" class="buffer-top">
            <a href="#tunes-manager">Tunes</a>
            <!-- tunes modal -->
            <div id="tunes-manager" class="modal fade in">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <a class="close" href="#"><span aria-hidden="true">x</span></a>
                            <h4 class="modal-title">Tunes</h4>
                        </div>
                        <div class="modal-body">
                            <!-- tunes table -->
                            <div>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th></th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr rv-each-tune="model.tunes" rv-class-active="tune.id | eq model.tune.id">
                                            <td>{ tune.name }</td>
                                            <td><a href="#" rv-on-click="actions.load">Load</a></td>
                                            <td><a href="#tunes-manager" rv-on-click="actions.delete">Delete</a></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- create tune -->
                            <div class="form-horizontal">
                                <h4>Create Tune</h4>
                                <div>
                                    <div class="form-group">
                                        <label for="new-tune-name" class="col-sm-2 control-label">Name</label>
                                        <div class="col-sm-10">
                                            <input id="new-tune-name" type="string" class="form-control" required rv-value="newTune.name" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="new-tune-instrument" class="col-sm-2 control-label">Instrument</label>
                                        <div class="col-sm-10">
                                            <select id="new-tune-instrument" class="form-control" required
                                                rv-value="newTune.instrumentName">
                                                <option rv-each-instrument="instruments" rv-value="instrument">{ instrument }</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-offset-2 col-sm-10">
                                            <button type="button" rv-on-click="actions.create">Create</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- tune -->
            <div class="buffer-top" rv-show="model.tune">
                <!-- tune details -->
                <div>
                    { model.tune.name }
                </div>
                <!-- tune parts -->
                <div class="buffer-top">
                    <!-- tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" rv-each-part="model.tune.parts" rv-class-active="part.id | eq model.part.id">
                            <a href="#" rv-on-click="actions.selectPart">{ part.name }</a>
                        </li>
                        <li role="presentation"><a href="#add-part"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></a></li>
                    </ul>
                    <!-- part options bar -->
                    <div class="buffer-sm">
                        <div class="part-options clearfix">
                            <div class="pull-left part-options__component">
                                BPM <input type="range" min="40" max="300" step="1" class="bpm-slider" rv-value="model.tune.bpm" rv-on-change="actions.save" /> { model.tune.bpm }
                            </div>
                            <div class="pull-left part-options__component btn-group" rv-show="audioModel.ready">
                                <a href="#" class="btn" role="button"><span class="glyphicon glyphicon-fast-backward" aria-hidden="true"></span></a>
                                <a href="#" class="btn" role="button" rv-hide="audioModel.playing"><span class="glyphicon glyphicon-play" aria-hidden="true"></span></a>
                                <a href="#" class="btn" role="button" rv-show="audioModel.playing"><span class="glyphicon glyphicon-pause" aria-hidden="true"></span></a>
                                <a href="#" class="btn" role="button" rv-show="audioModel.playing"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span></a>
                            </div>
                            <div class="pull-right part-options__component">
                                <a href="#edit-part" rv-on-click="actions.onPartEditing">Edit</a>
                                <a href="#" rv-on-click="actions.deletePart">Delete</a>
                            </div>
                        </div>
                    </div>
                    <!-- add part modal -->
                    <div id="add-part" class="modal fade in">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close" href="#"><span aria-hidden="true">x</span></a>
                                    <h4 class="modal-title">Add part</h4>
                                </div>
                                <div class="modal-body">
                                    <div class="form-horizontal">
                                        <div>
                                            <div class="form-group">
                                                <label for="new-part-instrument" class="col-sm-2 control-label">Instrument</label>
                                                <div class="col-sm-10">
                                                    <select id="new-part-instrument" class="form-control" required
                                                        rv-value="newPart.instrumentName" rv-on-change="newPart.selectInstrument">
                                                        <option rv-each-instrument="instruments" rv-value="instrument">{ instrument }</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="new-part-sound" class="col-sm-2 control-label">Sound</label>
                                                <div class="col-sm-10">
                                                    <select id="new-part-sound" class="form-control" required rv-value="newPart.sound">
                                                        <option rv-each-sound="newPart.sounds" rv-value="sound">{ sound }</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="new-part-name" class="col-sm-2 control-label">Name</label>
                                                <div class="col-sm-10">
                                                    <input id="new-part-name" type="string" class="form-control" placeholder="Defaults to the instrument if not specified" rv-value="newPart.name" />
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-10">
                                                    <button type="button" href="#" rv-on-click="actions.addPart">Add</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- edit part modal -->
                    <div id="edit-part" class="modal fade in">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <a class="close" href="#"><span aria-hidden="true">x</span></a>
                                    <h4 class="modal-title">Edit part</h4>
                                </div>
                                <div class="modal-body">
                                    <div class="form-horizontal">
                                        <div>
                                            <div class="form-group">
                                                <label for="edit-part-instrument" class="col-sm-2 control-label">Instrument</label>
                                                <div class="col-sm-10">
                                                    <select id="edit-part-instrument" class="form-control" required
                                                        rv-value="editPart.instrumentName" rv-on-change="editPart.selectInstrument">
                                                        <option rv-each-instrument="instruments" rv-value="instrument">{ instrument }</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="edit-part-sound" class="col-sm-2 control-label">Sound</label>
                                                <div class="col-sm-10">
                                                    <select id="edit-part-sound" class="form-control" required rv-value="editPart.sound">
                                                        <option rv-each-sound="editPart.sounds" rv-value="sound">{ sound }</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="edit-part-name" class="col-sm-2 control-label">Name</label>
                                                <div class="col-sm-10">
                                                    <input id="edit-part-name" type="string" class="form-control" rv-value="editPart.name" />
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-10">
                                                    <button type="button" href="#" rv-on-click="actions.updatePart">Update</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--tablature-->
        <section id="tablature" class="buffer" rv-show="model.ready">
            <div class="bars">
                <div class="bar bar__tab" rv-each-bar="model.bars">
                    <div class="crotchet" rv-each-crotchet="bar.crotchets">
                        <div class="quaver" rv-each-quaver="crotchet.quavers">
                            <div class="string" rv-each-string="quaver.strings">{ string.fret | default '&nbsp' }</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--audio-->
        <section id="audio" class="buffer">
            <div rv-show="model.ready">
                <form class="form-inline">
                    <div class="buffer-sm">
                        <button type="button" rv-on-click="actions.start">Start</button>
                        <button type="button" rv-on-click="actions.resume">Resume</button>
                        <button type="button" rv-on-click="actions.stop">Stop</button>
                    </div>
                    <div>
                        <div rv-each-note="notes">{ note.note }{ note.octave }</div>
                    </div>
                </form>
                <div class="buffer">
                    <h3>Mixer</h3>
                    <div class="mixer">
                        <div class="channel" rv-each-part="tune.parts">
                            <div class="heading">
                                { part.name }
                            </div>
                            <div class="fader">
                                <input type="range" min="0" max="1" step="0.01" rv-value="part.volume" rv-on-change="saveTune" />
                            </div>
                        </div>
                        <div class="channel">
                            <div class="heading">
                                Master
                            </div>
                            <div class="fader">
                                <input type="range" min="0" max="1" step="0.01" rv-value="tune.volume" rv-on-change="saveTune" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="loading" rv-show="model.loading">
                <br/>
                Loading sounds...
            </div>
        </section>
        <!--scripts-->
        <!--framework-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/rivets/0.8.1/rivets.bundled.min.js"></script>
        <!--midi-->
        <script src="js/lib/MIDI.js"></script>
        <script src="js/lib/shim/Base64.js" type="text/javascript"></script>
        <script src="js/lib/shim/Base64binary.js" type="text/javascript"></script>
        <script src="js/lib/shim/WebAudioAPI.js" type="text/javascript"></script>
        <!--app-->
        <script data-main="app/app" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.22/require.min.js"></script>
    </body>
</html>